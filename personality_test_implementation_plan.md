# 性格診断機能 実装プラン

## 📋 概要

`index.html`に性格診断機能を実装し、ウェブで完結する診断サービスを提供します。
まずは日本語で実装し、将来的に多言語化対応を行います。

---

## 🎯 実装目標

### 基本要件
- ✅ ウェブで完結する診断サービス（サーバーサイド不要）
- ✅ **1つの質問セットで複数の診断結果を同時に計算**（重要）
- ✅ 日本語で実装（多言語化は後続対応）
- ✅ モバイル対応（レスポンシブデザイン）
- ✅ アプリへの誘導（既存のApp Store/Google Playリンクを活用）

### 診断タイプ（質問セットは共有）
1. **独自診断（Profilecode診断）**（優先実装）
   - **5次元包括診断**: キャリア適性、学習スタイル、コミュニケーション、ストレス対処、意思決定
   - **実用性重視**: 就職、転職、スキルアップ、自己研鑽、恋愛などで直接活用可能
   - **差別化**: MBTI/16PFとは異なる側面を測定
   - 商標リスクなし
   - 詳細は `profilecode_diagnosis_design.md` を参照

2. **参考診断1: 4指標タイプ診断**（商標表記に注意）
   - 4つの指標（外向性/内向性、感覚/直観、思考/感情、判断/知覚）を測定
   - 16の性格タイプを判定
   - ⚠️ 商標表記: 「MBTI®はMyers-Briggs Type Indicator®の商標です。本サービスはMBTI®の公式サービスではありません。」

3. **参考診断2: 16因子診断**（商標表記に注意）
   - 16の性格因子を測定
   - ⚠️ 商標表記: 「16PF®は16 Personality Factor®の商標です。本サービスは16PF®の公式サービスではありません。」

### 重要な設計原則
- **質問の共有**: 1回の質問回答で、すべての診断タイプの結果を計算
- **商標リスクヘッジ**: 商標登録されている診断方法には適切な表記を追加
- **独自診断の優先**: 独自診断をメインにし、参考診断は補助的に表示

---

## 🏗️ アーキテクチャ設計

### ファイル構成

```
profilecode.codes/
├── index.html                    # ランディングページ（既存、診断開始ボタン追加）
├── test.html                     # 診断ページ（新規作成）
│   ├── 質問表示・回答収集（1回のみ）
│   ├── 進捗表示
│   └── 複数診断結果の表示
├── js/
│   ├── questions.js              # 共有質問データ（新規作成）
│   ├── personality-test.js       # 診断メインロジック（新規作成）
│   ├── calculators/
│   │   ├── profilecode-calculator.js    # 独自診断計算（新規作成、優先）
│   │   ├── four-indicator-calculator.js # 4指標診断計算（新規作成）
│   │   └── sixteen-factor-calculator.js # 16因子診断計算（新規作成）
│   └── result-display.js        # 結果表示ロジック（新規作成）
└── css/
    └── test.css                   # 診断ページ用スタイル（新規作成、オプション）
```

### データフロー（質問共有型）

```
1. index.html
   ↓ 「ウェブ診断を始める」クリック
   
2. test.html
   ↓ 質問表示・回答収集（1回のみ）
   ↓ LocalStorageに回答を保存
   
3. 結果計算（JavaScript、並列実行）
   ├── Profilecode診断計算（独自）
   ├── 4指標診断計算（参考）
   └── 16因子診断計算（参考）
   
4. 結果表示（test.html内）
   ├── メイン: Profilecode診断結果
   ├── 参考1: 4指標診断結果（商標表記付き）
   └── 参考2: 16因子診断結果（商標表記付き）
   ↓ アプリ誘導
```

### 質問データの設計（共有型）

- **統一質問セット**: すべての診断タイプで使用する質問を1つに統一
- **質問の特性**: 各質問は複数の診断タイプの計算に使用可能
- **マッピング**: 各質問がどの診断タイプのどの指標/因子に影響するかを定義

---

## 📐 実装フェーズ

### フェーズ1: 基本実装（質問共有型診断システム）

#### 1-1. 共有質問データの準備
- **統一質問セット**（日本語）を作成（30-50問）
- 各質問に4つの選択肢（強く同意、同意、反対、強く反対）
- **質問マッピング**: 各質問がどの診断タイプのどの指標/因子に影響するかを定義
  - Profilecode診断用マッピング
  - 4指標診断用マッピング
  - 16因子診断用マッピング

#### 1-2. 独自診断（Profilecode診断）の設計
- **5次元包括診断**を設計
  1. **キャリア適性次元**: 仕事への適性、職種マッチング（最優先）
  2. **学習スタイル次元**: 効率的な学習方法（優先）
  3. **コミュニケーションスタイル次元**: 人間関係の築き方
  4. **ストレス対処次元**: ストレスへの対応方法
  5. **意思決定スタイル次元**: 判断の仕方
- 各次元のタイプ分類を決定
- 独自の計算ロジックを実装
- 実用的なアドバイスを生成
- 商標リスクなし
- 詳細は `profilecode_diagnosis_design.md` を参照

#### 1-3. 診断ページ（test.html）の実装
- 質問表示UI（1回のみ）
- 回答選択UI（ラジオボタン or ボタン）
- 進捗バー
- 前へ/次へボタン
- 回答の保存（LocalStorage）

#### 1-4. 複数診断計算ロジックの実装
- **並列計算**: 1つの回答セットから複数の診断結果を同時に計算
  - Profilecode診断計算（優先）
  - 4指標診断計算（参考）
  - 16因子診断計算（参考）

#### 1-5. 結果表示の実装
- **メイン結果**: Profilecode診断結果を大きく表示
- **参考結果**: 4指標診断、16因子診断を補助的に表示
- **商標表記**: 参考診断には適切な商標表記を追加
- アプリ誘導（既存のApp Store/Google Playリンク）
- 結果の共有機能（オプション）

### フェーズ2: UI/UX改善

#### 2-1. デザイン改善
- アニメーション追加
- 進捗表示の改善
- 結果表示の視覚化

#### 2-2. ユーザビリティ改善
- 回答の確認機能
- 途中保存・再開機能
- 結果の保存機能

### フェーズ3: 多言語化対応

#### 3-1. 多言語化の準備
- 翻訳データの構造化
- 言語切り替え機能の実装

#### 3-2. 翻訳の追加
- 英語、中国語、韓国語など
- 質問データの翻訳
- UIテキストの翻訳

---

## 💻 技術仕様

### 使用技術
- **HTML5**: セマンティックマークアップ
- **CSS3**: モダンなスタイリング、レスポンシブデザイン
- **JavaScript (Vanilla)**: フレームワークなし、軽量実装
- **LocalStorage**: 回答の一時保存（オプション）

### データ構造

#### 共有質問データ（統一質問セット）
```javascript
const sharedQuestions = [
  {
    id: 1,
    question: '質問文',
    options: [
      { text: '強く同意', value: 2 },
      { text: '同意', value: 1 },
      { text: '反対', value: -1 },
      { text: '強く反対', value: -2 }
    ],
    // 各診断タイプへのマッピング
    mappings: {
      profilecode: {
        dimension: 'social_energy', // 独自診断の次元
        weight: 1.0
      },
      fourIndicator: {
        dimension: 'E/I', // 4指標診断の次元
        weight: 1.0
      },
      sixteenFactor: {
        dimension: 'warmth', // 16因子診断の因子
        weight: 0.8
      }
    }
  },
  // ...
];
```

#### 回答データ（1回の回答セット）
```javascript
const answers = [
  { questionId: 1, value: 2 },
  { questionId: 2, value: -1 },
  // ...
];
```

#### 診断結果データ（複数診断の結果）
```javascript
const results = {
  // メイン: 独自診断
  profilecode: {
    type: 'Creator', // 独自のタイプ名
    scores: {
      social_energy: 75,
      creativity: 80,
      // ...
    },
    description: 'あなたは創造的なタイプです...',
    traits: ['創造的', '熱心', '社交的', ...]
  },
  
  // 参考1: 4指標診断
  fourIndicator: {
    type: 'ENFP',
    scores: {
      E: 15, I: 5,
      S: 8, N: 12,
      T: 6, F: 14,
      J: 4, P: 16
    },
    description: 'ENFPの説明文...',
    trademark: 'MBTI®はMyers-Briggs Type Indicator®の商標です。本サービスはMBTI®の公式サービスではありません。'
  },
  
  // 参考2: 16因子診断
  sixteenFactor: {
    factors: {
      warmth: 65,
      reasoning: 70,
      // ... 16因子
    },
    description: '16因子診断の説明...',
    trademark: '16PF®は16 Personality Factor®の商標です。本サービスは16PF®の公式サービスではありません。'
  }
};
```

---

## 🎨 UI/UX設計

### 診断ページ（test.html）

#### レイアウト
```
┌─────────────────────────────┐
│  進捗バー (25%)              │
├─────────────────────────────┤
│                              │
│  質問文（大きく表示）        │
│                              │
│  [強く同意] [同意]          │
│  [反対] [強く反対]          │
│                              │
│  [前へ]        [次へ]       │
│                              │
└─────────────────────────────┘
```

#### デザイン方針
- シンプルで分かりやすいUI
- 大きなボタンでタップしやすい
- 進捗が視覚的に分かる
- モバイルファースト

### 結果表示（複数診断結果）

#### レイアウト
```
┌─────────────────────────────┐
│  【メイン結果】              │
│  あなたのProfilecodeタイプ   │
│  Creator                     │
│  (キャラクター画像)          │
├─────────────────────────────┤
│  説明文                      │
│  特徴:                      │
│  • 創造的                    │
│  • 熱心                      │
│  • 社交的                    │
├─────────────────────────────┤
│  【参考診断1】               │
│  4指標診断: ENFP             │
│  ⚠️ 商標表記                 │
├─────────────────────────────┤
│  【参考診断2】               │
│  16因子診断                  │
│  ⚠️ 商標表記                 │
├─────────────────────────────┤
│  [結果を共有]               │
│  [アプリで詳しく見る]       │
│  [もう一度診断する]         │
└─────────────────────────────┘
```

---

## 📝 実装詳細

### 1. index.htmlの修正

#### 変更点
- 「ウェブ診断を始める」ボタンのリンクを`/test.html`に変更
- 診断機能の説明を追加（オプション）

### 2. test.htmlの実装

#### 機能
- 質問の順次表示
- 回答の収集
- 進捗の表示
- 結果の計算
- 結果の表示

#### 実装方法
- 単一ページで完結（SPA風の実装）
- 質問表示 → 回答収集 → 結果表示の流れ
- JavaScriptで状態管理

### 3. 計算ロジック（複数診断の並列計算）

#### 計算フロー
1. **回答データの取得**: 1回の質問回答セットを取得
2. **並列計算**: 同じ回答データから複数の診断結果を同時に計算
   - Profilecode診断計算（独自ロジック）
   - 4指標診断計算（参考）
   - 16因子診断計算（参考）

#### Profilecode診断（独自）の計算例
```
1. 各次元のスコアを計算
   - キャリア適性: 創造的イノベーター型
   - 学習スタイル: 実践的体験学習者型
   - コミュニケーション: 共感的リスナー型
   - ストレス対処: 適応的リカバリー型
   - 意思決定: データドリブン型

2. 各次元のタイプを判定
   - 各次元で複数のタイプ候補から判定

3. 実用的なアドバイスを生成
   - 各次元の結果を統合
   - 活用シーン別のアドバイス
```

#### 4指標診断（参考）の計算例
```
E: 15, I: 5 → E
S: 8, N: 12 → N
T: 6, F: 14 → F
J: 4, P: 16 → P

結果: ENFP
（商標表記を追加）
```

#### 16因子診断（参考）の計算例
```
各因子のスコアを計算
- warmth: 65
- reasoning: 70
- emotional_stability: 60
- ...
（商標表記を追加）
```

---

## 🔄 多言語化の準備

### 実装方針
- 翻訳データをJSON形式で管理
- 言語切り替え機能を実装
- 既存の多言語対応（privacy-policy, eula）と同様の構造

### データ構造
```javascript
const translations = {
  ja: {
    title: '性格診断',
    startButton: '診断を始める',
    // ...
  },
  en: {
    title: 'Personality Test',
    startButton: 'Start Test',
    // ...
  },
  // ...
};
```

---

## ✅ 実装チェックリスト

### フェーズ1: 基本実装（質問共有型）
- [ ] **共有質問データの作成**（日本語、30-50問）
- [ ] **質問マッピングの定義**（各診断タイプへのマッピング）
- [ ] **独自診断（Profilecode診断）の設計**
  - [ ] 5次元包括診断の設計
    - [ ] キャリア適性次元（最優先）
    - [ ] 学習スタイル次元（優先）
    - [ ] コミュニケーションスタイル次元
    - [ ] ストレス対処次元
    - [ ] 意思決定スタイル次元
  - [ ] 各次元のタイプ分類を決定
  - [ ] 独自の計算ロジック
  - [ ] 実用的なアドバイスの生成
  - [ ] 詳細設計: `profilecode_diagnosis_design.md` を参照
- [ ] test.htmlの作成
- [ ] 質問表示UIの実装（1回のみ）
- [ ] 回答選択UIの実装
- [ ] 進捗表示の実装
- [ ] **複数診断計算ロジックの実装**（並列計算）
  - [ ] Profilecode診断計算
  - [ ] 4指標診断計算
  - [ ] 16因子診断計算
- [ ] **結果表示の実装**（複数診断結果）
  - [ ] メイン結果（Profilecode診断）
  - [ ] 参考結果（4指標診断、商標表記付き）
  - [ ] 参考結果（16因子診断、商標表記付き）
- [ ] アプリ誘導の実装
- [ ] モバイル対応の確認
- [ ] 動作テスト

### フェーズ2: UI/UX改善
- [ ] アニメーション追加
- [ ] デザイン改善
- [ ] ユーザビリティ改善

### フェーズ3: 多言語化
- [ ] 翻訳データ構造の設計
- [ ] 言語切り替え機能の実装
- [ ] 英語翻訳の追加
- [ ] その他言語の翻訳追加

---

## 🚀 実装優先順位

### 最優先（MVP）
1. MBTI質問データ（簡易版20-30問）
2. test.htmlの基本実装
3. 計算ロジックの実装
4. 結果表示の実装

### 次優先
1. UI/UX改善
2. 質問数の拡充（50-60問）
3. 結果の共有機能

### 将来対応
1. 多言語化
2. 質問数の拡充
3. 結果の保存機能（アカウント連携）
4. 新しい独自診断タイプの追加

---

## 📊 想定される質問数と所要時間

### 簡易版（20-30問）
- 所要時間: 約5-10分
- 実装工数: 低
- 精度: 中

### 標準版（50-60問）
- 所要時間: 約15-20分
- 実装工数: 中
- 精度: 高

### 推奨
- まずは簡易版で実装
- ユーザーフィードバックを収集
- 必要に応じて質問数を拡充

---

## 🎯 成功指標

### ユーザー体験
- 診断完了率: 80%以上
- 平均所要時間: 10分以内
- モバイルでの使いやすさ

### 技術指標
- ページ読み込み時間: 3秒以内
- レスポンシブ対応: 全デバイス
- ブラウザ互換性: 主要ブラウザ対応

---

## 📝 次のステップ

1. **独自診断（Profilecode診断）の設計**
   - 5次元包括診断の設計（詳細は `profilecode_diagnosis_design.md` を参照）
   - キャリア適性次元のタイプ分類を決定（最優先）
   - 学習スタイル次元のタイプ分類を決定（優先）
   - 各次元の計算ロジックを設計
   - 実用的なアドバイスの生成ロジックを設計

2. **共有質問データの作成**
   - 統一質問セット（日本語、30-50問）を準備
   - 各質問のマッピングを定義（各診断タイプへの影響）

3. **test.htmlの実装**
   - 基本UIの実装
   - 質問表示・回答収集機能（1回のみ）

4. **複数診断計算ロジックの実装**
   - Profilecode診断計算（優先）
   - 4指標診断計算（参考、商標表記付き）
   - 16因子診断計算（参考、商標表記付き）

5. **結果表示の実装**
   - メイン結果（Profilecode診断）の表示
   - 参考結果（4指標診断、16因子診断）の表示
   - 商標表記の追加
   - アプリ誘導

---

## ⚠️ 商標リスクヘッジ

### 商標表記の実装

#### 4指標診断の場合
```html
<div class="reference-result">
  <h3>参考診断: 4指標タイプ診断</h3>
  <p class="trademark-notice">
    ⚠️ MBTI®はMyers-Briggs Type Indicator®の商標です。<br>
    本サービスはMBTI®の公式サービスではありません。
  </p>
  <!-- 診断結果 -->
</div>
```

#### 16因子診断の場合
```html
<div class="reference-result">
  <h3>参考診断: 16因子診断</h3>
  <p class="trademark-notice">
    ⚠️ 16PF®は16 Personality Factor®の商標です。<br>
    本サービスは16PF®の公式サービスではありません。
  </p>
  <!-- 診断結果 -->
</div>
```

### 商標リスクヘッジのポイント
1. **独自診断をメインに**: Profilecode診断を主要結果として表示
2. **参考診断として位置づけ**: 4指標診断、16因子診断は「参考」として表示
3. **明確な商標表記**: 商標登録されている診断方法には適切な表記を追加
4. **非公式の明示**: 公式サービスではないことを明記

---

**作成日**: 2024年
**最終更新**: 2024年
**作成者**: profilecode開発チーム

